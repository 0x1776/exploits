# Exploit for Seowintech Routers diagnostic.cgi Unauthenticated Remote Root Code Execution

This is an exploit for an old bug, found the exploit code lurking around in one of my old hard drives, cleaned it up, and decided to release it. Basically, a long while back, a rather interesting exploit was disclosed which affected
*ALL* Seowontech devices. Technically, it is two exploits. A remote root command injection bug, and a remote root file disclosure bug. In this, I only bother with the command injection bug. These vulnerabilities were found by one Todor Donev.  
The bug we are abusing is quite simple. Like many router bugs, it exists in a CGI script, that is used for network diagnostics. It is the bit for pinging that is vulnerable to our abuse.  
PoC:  
```
http://target.com/cgi-bin/diagnostic.cgi?select_mode_ping=on&ping_ipaddr=-q -s 0 127.0.0.1;id;&ping_count=1&action=Apply&html_view=ping
```
As you can see, the "ping_ipaddr" GET variable accepts arguments, and we can inject a command here. Essentially those are passed to a system call and executed without any sanitization. Internet of junk, people.

These devices are MIPS Busybox devices, which is basically a stripped  down, castrated, Linux. They are quite useful though ;). These devices do not have a compiler on them (what a surprise), and like most routers, changes that don't get written to nvram are not stored across reboots.


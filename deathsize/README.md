# LifeSize Room 5.0.9, remote config disclosure, code execution & local privilege escalation

Ultimately the Lifesize Room products have fundamentally flawed firmware, many similar very bugs in the WebUI exist and thier support team have been recommending that port 443 isn't accessible via the internet.

They've been alerted to several very similar bugs, and in some cases have fixed one gaping security hole only to leave another one literally 10 lines above completely untouched. *facepalm*

What makes this different? This exploit will run your payload as `root`.

## Description

This exploit uses the `LsSystemRestore.sh` script to disclose the current
configuration, that is then leveraged to gain access to exploitable APIs in
the admin portal which allow arbitrary command injection, then uses a local
privilege escalation bug to execute the payload as root.
 
This will work as long as port 443 is open on the phone, Lifesize support
should recommend that the power and ethernet cables are disconnected from the
device to ensure it remains secure.
 
`LsSystemRestore.sh` allows `autosh` commands to be executed without any
authentication, this is used to grab the Admin password via the `get config -P`
command.
 
Using the Admin password AMF commands can be sent to the LSRoom_Remoting
endpoint, this contains a method called `doPrefCommand` which is vulnerable to
command injection.
 
Local privilege escalation to root is gained by executing the setuid
`tcpdump_manager` executable, which runs a program called `reset_tcpdump`
from the current directory...

## Usage

```
$ deathsize.php 192.168.40.39 payload
[*] Retrieving admin password
[*] Saving config for 192.168.40.39
[*] Admin password is: 1234
[*] Authenticating for AMF RPC
[*] Sending command: ...
...
```

This will save the configuration for the device into the local file `192.168.40.39.config` and then execute the code in your payload file as `root` on the device and print out the response.
